<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>WeatherMapProject</title>

    <link rel="stylesheet" href="css/WeatherMapStyling.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src='https://api.mapbox.com/mapbox-gl-js/v2.3.1/mapbox-gl.js'></script>
    <link href='https://api.mapbox.com/mapbox-gl-js/v2.3.1/mapbox-gl.css' rel='stylesheet'/>
  <script src="./js/mapbox-geocoder-utils.js"></script>

</head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

<style>

  .weather{
  "id": 500,
  "main": "Rain",
  "description": "light rain",
  "icon": "10n"
  }


</style>



<!--   This is where my 1st navbar is -->
<nav class="navbar navbar-white bg-primary">
    <div class="container-fluid">

    <span class="navbar-text">
      Weather App
    </span>
        <span class="text">
      Current city: &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &nbsp;

    </span>
    </div>
</nav>

<br>

<!--   This is where my seach box is -->
<nav class="navbar navbar-light bg-light">
    <div class="container-fluid">
        <p style="color: #070707"> Place </p>
        <div id="searchbox">
            <form class="d-flex">
                <input class="form-control " type="search" placeholder="Search" aria-label="Search">
                <button class="btn btn-outline-success"  id="button1">Search</button>
            </form>
        </div>
    </div>
</nav>

<!--   These are my cards. -->
<div class="container-fluid mb-4">
  <div class="row justify-content-center row-cols-sm-2 row-cols-md-3 row-cols-lg-4 row-cols-xl-5" id="card-holder">
<!--    <div class="col mt-4">-->
<!--      <div class="card" style="width: 18rem;">-->
<!--        <div class="card-header" id="Date1">-->
<!--        </div>-->



<!--        <ul class="list-group list-group-flush">-->
<!--          <li class="list-group-item" id="WeatherTemp1">  <li list style=" list-style-type: none"> <img id="Img1"></li>-->
<!--          <li class="list-group-item" id="theDescription1">A second item</li>-->
<!--          <li class="list-group-item" ID="theWind1">A third item</li>-->
<!--          <li class="list-group-item" id="theHumidity1">A third item</li>-->
<!--          <li class="list-group-item" id="thePressure1">A third item</li>-->
<!--        </ul>-->
<!--      </div>-->
<!--    </div>-->


<!--    <div class="col mt-4">-->
<!--      <div class="card" style="width: 18rem;">-->
<!--        <div class="card-header" id="Date2">-->

<!--        </div>-->
<!--        <ul class="list-group list-group-flush">-->
<!--          <li class="list-group-item" id="WeatherTemp2">  <li list style=" list-style-type: none"> <img id="Img2"> </li>-->
<!--          <li class="list-group-item" id="theDescription2">A second item</li>-->
<!--          <li class="list-group-item" id="theWind2">A third item</li>-->
<!--          <li class="list-group-item" id="theHumidity2">A third item</li>-->
<!--          <li class="list-group-item" id="thePressure2">A third item</li>-->

<!--        </ul>-->
<!--      </div>-->
<!--    </div>-->
<!--    <div class="col mt-4">-->
<!--      <div class="card" style="width: 18rem;">-->
<!--        <div class="card-header" id="Date3">-->

<!--        </div>-->
<!--        <ul class="list-group list-group-flush">-->
<!--          <li class="list-group-item" id="WeatherTemp3"><li list style=" list-style-type: none"> <img id="Img3"></li>-->
<!--          <li class="list-group-item" id="theDescription3">A second item</li>-->
<!--          <li class="list-group-item" id="theWind3">A third item</li>-->
<!--          <li class="list-group-item" id="theHumidity3">A third item</li>-->
<!--          <li class="list-group-item" id="thePressure3">A third item</li>-->

<!--        </ul>-->
<!--      </div>-->
<!--    </div>-->
<!--    <div class="col mt-4">-->
<!--      <div class="card" style="width: 18rem;">-->
<!--        <div class="card-header" id="Date4">-->

<!--        </div>-->
<!--        <ul class="list-group list-group-flush">-->
<!--          <li class="list-group-item" id="WeatherTemp4"><li list style=" list-style-type: none"> <img id="Img4"></li>-->
<!--          <li class="list-group-item" id="theDescription4">A second item</li>-->
<!--          <li class="list-group-item" id="theWind4">A third item</li>-->
<!--          <li class="list-group-item" id="theHumidity4">A third item</li>-->
<!--          <li class="list-group-item" id="thePressure4">A third item</li>-->

<!--        </ul>-->
<!--      </div>-->
<!--    </div>-->
<!--    <div class="col mt-4" >-->
<!--      <div class="card" style="width: 18rem;">-->
<!--        <div class="card-header" id="Date5">-->

<!--        </div>-->
<!--        <ul class="list-group list-group-flush">-->
<!--          <li class="list-group-item" id="WeatherTemp5"><li list style=" list-style-type: none"> <img id="Img5"></li>-->
<!--          <li class="list-group-item" id="theDescription5">A second item</li>-->
<!--          <li class="list-group-item" id="theWind5">A third item</li>-->
<!--          <li class="list-group-item" id="theHumidity5">A third item</li>-->
<!--          <li class="list-group-item" id="thePressure5">A third item</li>-->

<!--        </ul>-->
<!--      </div>-->
<!--    </div>-->
  </div>
</div>




<body>


<div class = "row justify-content-center">
<div id='map' style='width: 97%; height: 50vh ;'></div>
</div>


<script src="./js/keys.js"></script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>



<script>



  // <!--   This is where jquery comes in to play -->




  $(document).ready(function () {
   var Longitude = -98.4916
    var Latitude = 29.4252

    mapboxgl.accessToken = mapBoxAPIKey ;

    var map = new mapboxgl.Map({

      container: 'map',
      style: 'mapbox://styles/mapbox/streets-v9',
      zoom: 5,
      center: [Longitude, Latitude]




    });

    var marker = new mapboxgl.Marker({
      draggable: true
    })
    marker.setLngLat([Longitude, Latitude])
    marker.addTo(map)
WeatherData(Longitude,Latitude)
    function WeatherData(lon,lat) {
      $.get(`https://api.openweathermap.org/data/2.5/onecall?`, {
        appid: OpenWeatherAPIKey,
        lat: lat,
        lon: lon,
        units: "imperial"
      }).done(function (data) {


          console.log(data)
          for (let i = 0; i < 5; i++) {
              let html = "";

              let Description =   data.daily[i].weather[0].description;

              let WeatherIcon = data.daily[i].weather[0].icon;
              let iconurl = "<img src='https://openweathermap.org/img/w/" + WeatherIcon + ".png' </img> "
              let humidity = data.daily[i].humidity;
              let date = new Date(data.daily[i].dt * 1000).toISOString().substr(0, 10)
              let temperature = data.daily[i].temp.day
              let WindData = data.daily[i].wind_speed
              html+= ` <div class="col mt-4">
      <div class="card" style="width: 18rem;">
        <div class="card-header" id="Date2" <p>${date} </p>

        </div>
        <ul class="list-group list-group-flush">
          <li class="list-group-item" id="WeatherTemp2"> ${iconurl + temperature}  </li>
          <li class="list-group-item" id="theDescription2">${Description}</li>
          <li class="list-group-item" id="theWind2"> Humidity: ${humidity}</li>
          <li class="list-group-item" id="theHumidity2">${date}</li>

           <li class="list-group-item" id="twind">${WindData}</li>

        </ul>
      </div>
    </div>`
        $('#card-holder').append(html)

          }
        // console.log(data.daily[0])
        // MyWeatherobject = data
        // var dayOneHumidity = data.daily[0].humidity
        // var dayTwoHumidity = data.daily[1].humidity
        // var dayThreeHumidity = data.daily[2].humidity
        // var dayFourHumdity = data.daily[3].humidity
        // var dayFiveHumidity = data.daily[4].humidity
        // $('#theHumidity1').html("Humidity: " + dayOneHumidity)
        // $('#theHumidity2').html("Humidity: " + dayTwoHumidity)
        // $('#theHumidity3').html("Humidity: " + dayThreeHumidity)
        // $('#theHumidity4').html("Humidity: " + dayFourHumdity)
        // $('#theHumidity5').html("Humidity: " + dayFiveHumidity)
        //
        //
        // var Datedata1 = new Date(data.daily[0].dt * 1000).toISOString().substr(0, 10)
        // var Datedata2 = new Date(data.daily[1].dt * 1000).toISOString().substr(0, 10)
        // var Datedata3 = new Date(data.daily[2].dt * 1000).toISOString().substr(0, 10)
        // var Datedata4 = new Date(data.daily[3].dt * 1000).toISOString().substr(0, 10)
        // var Datedata5 = new Date(data.daily[4].dt * 1000).toISOString().substr(0, 10)
        // $('#Date1').html(Datedata1)
        // $('#Date2').html(Datedata2)
        // $('#Date3').html(Datedata3)
        // $('#Date4').html(Datedata4)
        // $('#Date5').html(Datedata5)
        //
        //
        // var PressureData1 = data.daily[0].pressure
        // var PressureData2 = data.daily[1].pressure
        // var PressureData3 = data.daily[2].pressure
        // var PressureData4 = data.daily[3].pressure
        // var PressureData5 = data.daily[4].pressure
        // $('#thePressure1').html("Pressure: " + PressureData1)
        // $('#thePressure2').html("Pressure: " + PressureData2)
        // $('#thePressure3').html("Pressure: " + PressureData3)
        // $('#thePressure4').html("Pressure: " + PressureData4)
        // $('#thePressure5').html("Pressure: " + PressureData5)
        //
        //
        // var WindData1 = data.daily[0].wind_speed
        // var WindData2 = data.daily[1].wind_speed
        // var WindData3 = data.daily[2].wind_speed
        // var WindData4 = data.daily[3].wind_speed
        // var WindData5 = data.daily[4].wind_speed
        // $('#theWind1').html("Wind: " + WindData1)
        // $('#theWind2').html("Wind: " + WindData2)
        // $('#theWind3').html("Wind: " + WindData3)
        // $('#theWind4').html("Wind: " + WindData4)
        // $('#theWind5').html("Wind: " + WindData5)
        //
        //
        // var DescriptionData1 = data.daily[i].weather[i].description
        // var DescriptionData2 = data.daily[1].weather[0].description
        // var DescriptionData3 = data.daily[2].weather[0].description
        // var DescriptionData4 = data.daily[3].weather[0].description
        // var DescriptionData5 = data.daily[4].weather[0].description
        //
        //
        // $('#theDescription1').html("Description: " + DescriptionData1)
        // $('#theDescription2').html("Description: " + DescriptionData2)
        // $('#theDescription3').html("Description: " + DescriptionData3)
        // $('#theDescription4').html("Description: " + DescriptionData4)
        // $('#theDescription5').html("Description: " + DescriptionData5)
        //
        //
        // var temperature1 = data.daily[0].temp.day
        // var temperature2 = data.daily[1].temp.day
        // var temperature3 = data.daily[2].temp.day
        // var temperature4 = data.daily[3].temp.day
        // var temperature5 = data.daily[4].temp.day
        //
        // var max1 = data.daily[0].temp.max
        // var max2 = data.daily[1].temp.max
        // var max3 = data.daily[2].temp.max
        // var max4 = data.daily[3].temp.max
        // var max5 = data.daily[4].temp.max
        //
        //
        // var iconcode = data.daily[0].weather[0].icon;
        // var iconcode2 = data.daily[1].weather[0].icon;
        // var iconcode3 = data.daily[2].weather[0].icon;
        // var iconcode4 = data.daily[3].weather[0].icon;
        // var iconcode5 = data.daily[4].weather[0].icon;
        //
        // var iconurl = "http://openweathermap.org/img/w/" + iconcode + ".png";
        // var iconurl2 = "http://openweathermap.org/img/w/" + iconcode2 + ".png";
        // var iconurl3 = "http://openweathermap.org/img/w/" + iconcode3 + ".png";
        // var iconurl4 = "http://openweathermap.org/img/w/" + iconcode4 + ".png";
        // var iconurl5 = "http://openweathermap.org/img/w/" + iconcode5 + ".png";
        //
        //
        // $("#Img1").attr("src", iconurl)
        // $("#Img2").attr("src", iconurl2)
        // $("#Img3").attr("src", iconurl3)
        // $("#Img4").attr("src", iconurl4)
        // $("#Img5").attr("src", iconurl5)
        //
        // // var DescriptionData1img = data.daily[0].weather[0].icon
        // // var DescriptionData2img = data.daily[1].weather[0].icon
        // // var DescriptionData3img = data.daily[2].weather[0].icon
        // // var DescriptionData4img= data.daily[3].weather[0].icon
        // // var DescriptionData5img = data.daily[4].weather[0].icon
        //
        // $('#WeatherTemp1').html(temperature1 + '/' + max1 + '&#8457')
        // $('#WeatherTemp2').html(temperature2 + "/" + max2 + '&#8457;')
        // $('#WeatherTemp3').html(temperature3 + '/' + max3 + '&#8457;')
        // $('#WeatherTemp4').html(temperature4 + "/" + max4 + '&#8457;')
        // $('#WeatherTemp5').html(temperature5 + "/" + max5 + '&#8457;')
        //
        // console.log(data)


      })
    }

// Now I have to ReverseGeo to find the cityname returned up top




            function onDragEnd() {
      var lngLat = marker.getLngLat();
      map.setCenter([lngLat.lng, lngLat.lat])
      map.setZoom(5)
      WeatherData(lngLat.lng, lngLat.lat)
      console.log(lngLat)
    }

    marker.on('dragend', onDragEnd);


    $('#button1').click(function (event) {
      event.preventDefault();
      var searchBar = $('input').val();
      console.log(searchBar);



      geocode(searchBar, mapBoxAPIKey).then(function (areaCoordinates) {
        console.log(areaCoordinates)
        map.setCenter(areaCoordinates)
        marker.setLngLat(areaCoordinates)
        WeatherData(areaCoordinates[0], areaCoordinates[1]);}

      ) }

    )}
  )

</script>
</body>
</html>


